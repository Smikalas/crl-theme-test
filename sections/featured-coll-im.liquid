{% liquid
  assign section_name = 'collection-fullwidth-' | append: section.id
%}

{%- style -%}
.{{ section_name }} .collection-item {
  position: relative;
  overflow: hidden;
  aspect-ratio: {{ section.settings.image_ratio }};
}

.{{ section_name }} .collection-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.6s ease;
}

.{{ section_name }} .collection-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: {{ section.settings.overlay_color }};
  opacity: 0;
  transition: opacity 0.3s ease;
}

.{{ section_name }} .collection-content {
  position: absolute;
  bottom: 2rem;
  left: 2rem;
  z-index: 2;
}

.{{ section_name }} .collection-title {
  color: {{ section.settings.text_color }};
  font-size: 1.5rem;
  margin: 0;
  position: relative;
  display: inline-block;
}

.{{ section_name }} .collection-title::after {
  content: '';
  position: absolute;
  width: 0;
  height: 2px;
  bottom: -4px;
  left: 0;
  background-color: {{ section.settings.text_color }};
  transition: width 0.3s ease;
}

.{{ section_name }} .collection-item:hover .collection-image {
  transform: scale(1.05);
}

.{{ section_name }} .collection-item:hover .collection-overlay {
  opacity: {{ section.settings.overlay_opacity }};
}

.{{ section_name }} .collection-item:hover .collection-title::after {
  width: 100%;
}
{%- endstyle -%}

<div class="page-width-{{ section.settings.width }}">
  <div class="{{ section_name }} grid grid--1-col">
    {% for block in section.blocks %}
      {% if block.settings.collection != blank %}
        <div class="grid__item" {{ block.shopify_attributes }}>
          <a href="{{ block.settings.collection.url }}" class="collection-item">
            {%- if block.settings.collection.image != blank -%}
              {% render 'image', 
                image: block.settings.collection.image,
                sizes: '100vw',
                class: 'collection-image'
              %}
            {%- else -%}
              {{ 'collection-1' | placeholder_svg_tag: 'collection-image placeholder' }}
            {%- endif -%}
            <div class="collection-overlay"></div>
            <div class="collection-content">
              <h2 class="collection-title h1">{{ block.settings.collection.title }}</h2>
            </div>
          </a>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "Collection Full Width",
  "settings": [
    {
      "type": "select",
      "id": "width",
      "label": "Section width",
      "options": [
        {
          "value": "full",
          "label": "Full width"
        },
        {
          "value": "contained",
          "label": "Contained"
        }
      ],
      "default": "full"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "label": "Image ratio",
      "options": [
        {
          "value": "1/1",
          "label": "Square"
        },
        {
          "value": "16/9",
          "label": "Landscape"
        },
        {
          "value": "2/3",
          "label": "Portrait"
        }
      ],
      "default": "16/9"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "label": "Overlay opacity",
      "default": 0.4
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Collection"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection Full Width",
      "blocks": [
        {
          "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}
